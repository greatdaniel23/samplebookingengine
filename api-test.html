<!DOCTYPE html>
<html>
<head>
    <title>API Test</title>
</head>
<body>
    <h1>API Test</h1>
    <button onclick="testAPI()">Test POST Booking</button>
    <button onclick="testGET()">Test GET Bookings</button>
    <button onclick="testPaths()">Test Path Config</button>
    <div id="result"></div>

    <script>
    async function testAPI() {
        const resultDiv = document.getElementById('result');
        
        // Test data that matches what the frontend sends
        const testBooking = {
            roomId: "master-suite",
            from: "2025-12-01",
            to: "2025-12-03", 
            guests: 2,
            user: {
                firstName: "Test",
                lastName: "User",
                email: "test@example.com",
                phone: "1234567890"
            },
            total: 299.99
        };

        const apiUrl = 'http://localhost/fontend-bookingengine-100/frontend-booking-engine/api/bookings';
        
        resultDiv.innerHTML = '<p>Testing API endpoint: ' + apiUrl + '</p>';
        
        try {
            console.log('Sending POST request to:', apiUrl);
            console.log('Data:', testBooking);
            
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(testBooking)
            });

            console.log('Response status:', response.status);
            console.log('Response headers:', [...response.headers.entries()]);

            const responseText = await response.text();
            console.log('Response text:', responseText);

            let responseData;
            try {
                responseData = JSON.parse(responseText);
                console.log('Parsed response:', responseData);
            } catch (e) {
                console.error('JSON parse failed:', e);
                responseData = { error: 'Invalid JSON response', raw: responseText };
            }

            resultDiv.innerHTML = `
                <h3>Response:</h3>
                <p><strong>Status:</strong> ${response.status}</p>
                <p><strong>Success:</strong> ${response.ok}</p>
                <p><strong>Data:</strong></p>
                <pre>${JSON.stringify(responseData, null, 2)}</pre>
            `;

        } catch (error) {
            console.error('Fetch error:', error);
            resultDiv.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
        }
    }

    async function testGET() {
        const resultDiv = document.getElementById('result');
        const apiUrl = 'http://localhost/fontend-bookingengine-100/frontend-booking-engine/api/bookings';
        
        try {
            console.log('Testing GET request to:', apiUrl);
            const response = await fetch(apiUrl, { method: 'GET' });
            
            console.log('GET Response status:', response.status);
            const data = await response.json();
            
            resultDiv.innerHTML = `
                <h3>GET Test Result:</h3>
                <p><strong>Status:</strong> ${response.status}</p>
                <p><strong>Success:</strong> ${response.ok}</p>
                <p><strong>Data:</strong></p>
                <pre>${JSON.stringify(data, null, 2)}</pre>
            `;
        } catch (error) {
            console.error('GET Error:', error);
            resultDiv.innerHTML = `<p style="color: red;">GET Error: ${error.message}</p>`;
        }
    }

    function testPaths() {
        const resultDiv = document.getElementById('result');
        
        // Test path construction
        const baseApi = 'http://localhost/fontend-bookingengine-100/frontend-booking-engine/api';
        const bookingsEndpoint = baseApi + '/bookings';
        
        resultDiv.innerHTML = `
            <h3>Path Configuration Test:</h3>
            <p><strong>Base API:</strong> ${baseApi}</p>
            <p><strong>Bookings Endpoint:</strong> ${bookingsEndpoint}</p>
            <p><strong>Current Frontend Origin:</strong> ${window.location.origin}</p>
            <p><strong>Expected Connection:</strong> Frontend (${window.location.origin}) â†’ API (${bookingsEndpoint})</p>
        `;
    }
    </script>
</body>
</html>