<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard API Test</title>
    <script src="config.js"></script>
</head>
<body>
    <h1>Admin Dashboard API Test</h1>
    <div id="results"></div>

    <script>
        async function testAPIs() {
            const results = document.getElementById('results');
            results.innerHTML = '<p>Testing APIs...</p>';

            // Test 1: Config.js functionality
            try {
                console.log('üîß Testing config.js...');
                console.log('CONFIG available:', typeof window.CONFIG !== 'undefined');
                console.log('getApiUrl available:', typeof window.getApiUrl !== 'undefined');
                
                if (window.getApiUrl) {
                    const villaApiUrl = window.getApiUrl('villa.php');
                    console.log('Villa API URL:', villaApiUrl);
                    results.innerHTML += `<p>‚úÖ Config.js working - Villa API URL: ${villaApiUrl}</p>`;
                } else {
                    results.innerHTML += '<p>‚ùå Config.js not loaded properly</p>';
                    return;
                }
            } catch (error) {
                results.innerHTML += `<p>‚ùå Config.js error: ${error.message}</p>`;
                return;
            }

            // Test 2: Villa API GET
            try {
                console.log('üè® Testing Villa API GET...');
                const villaApiUrl = window.getApiUrl('villa.php');
                const response = await fetch(villaApiUrl);
                const data = await response.json();
                
                console.log('Villa API Response:', data);
                
                if (data.success) {
                    results.innerHTML += `<p>‚úÖ Villa API GET working - Villa: ${data.data.name}</p>`;
                } else {
                    results.innerHTML += `<p>‚ö†Ô∏è Villa API GET returned: ${data.message || 'No success'}</p>`;
                }
            } catch (error) {
                results.innerHTML += `<p>‚ùå Villa API GET error: ${error.message}</p>`;
            }

            // Test 3: Villa API PUT
            try {
                console.log('üîÑ Testing Villa API PUT...');
                const villaApiUrl = window.getApiUrl('villa.php');
                
                const testData = {
                    name: 'Villa Daisy Cantik - ADMIN TEST',
                    email: 'test@rumahdaisycantik.com',
                    phone: '+62 361 234 5678',
                    description: 'Test update from admin dashboard'
                };

                const response = await fetch(villaApiUrl, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(testData),
                });
                
                const data = await response.json();
                console.log('Villa API PUT Response:', data);
                
                if (data.success) {
                    results.innerHTML += '<p>‚úÖ Villa API PUT working - Update successful</p>';
                } else {
                    results.innerHTML += `<p>‚ùå Villa API PUT failed: ${data.message || data.error}</p>`;
                }
            } catch (error) {
                results.innerHTML += `<p>‚ùå Villa API PUT error: ${error.message}</p>`;
            }

            results.innerHTML += '<p><strong>Test completed!</strong></p>';
        }

        // Run tests when page loads
        window.addEventListener('load', function() {
            // Wait for config.js to fully load
            setTimeout(testAPIs, 500);
        });
    </script>
</body>
</html>