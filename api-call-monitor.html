<!DOCTYPE html>
<html>
<head>
    <title>üîç API Call Monitor</title>
    <meta charset="utf-8">
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            max-width: 1000px; 
            margin: 20px auto; 
            padding: 20px; 
            background: #f8f9fa;
        }
        .header { 
            background: white; 
            padding: 25px; 
            border-radius: 8px; 
            margin-bottom: 25px; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.1); 
            text-align: center;
        }
        .monitor-card { 
            background: white; 
            padding: 20px; 
            border-radius: 8px; 
            margin-bottom: 15px; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.1); 
        }
        .success { border-left: 5px solid #28a745; }
        .error { border-left: 5px solid #dc3545; }
        .warning { border-left: 5px solid #ffc107; }
        .info { border-left: 5px solid #17a2b8; }
        .api-call { 
            background: #f8f9fa; 
            padding: 10px; 
            margin: 5px 0; 
            border-radius: 4px; 
            font-family: monospace; 
            font-size: 12px;
        }
        .production-call { background: #d4edda; color: #155724; }
        .localhost-call { background: #f8d7da; color: #721c24; }
        .button { 
            background: #007bff; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            border-radius: 4px; 
            cursor: pointer; 
            margin: 5px;
        }
        .button:hover { background: #0056b3; }
        .stats { display: flex; justify-content: space-around; margin: 20px 0; }
        .stat { text-align: center; }
        .stat-number { font-size: 24px; font-weight: bold; }
        .stat-label { color: #666; font-size: 14px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üîç API Call Monitor</h1>
        <p>Real-time monitoring of all API calls to verify they go to <strong>api.rumahdaisycantik.com</strong></p>
        <button class="button" onclick="startMonitoring()">üöÄ Start Monitoring</button>
        <button class="button" onclick="clearLog()">üßπ Clear Log</button>
    </div>

    <div class="stats" id="stats">
        <div class="stat">
            <div class="stat-number" id="totalCalls">0</div>
            <div class="stat-label">Total Calls</div>
        </div>
        <div class="stat">
            <div class="stat-number" id="productionCalls">0</div>
            <div class="stat-label">Production API</div>
        </div>
        <div class="stat">
            <div class="stat-number" id="localhostCalls">0</div>
            <div class="stat-label">Localhost API</div>
        </div>
    </div>

    <div id="monitor">
        <!-- API calls will be logged here -->
    </div>

    <script>
        const monitorDiv = document.getElementById('monitor');
        let totalCalls = 0;
        let productionCalls = 0;
        let localhostCalls = 0;
        let isMonitoring = false;

        function updateStats() {
            document.getElementById('totalCalls').textContent = totalCalls;
            document.getElementById('productionCalls').textContent = productionCalls;
            document.getElementById('localhostCalls').textContent = localhostCalls;
        }

        function logApiCall(method, url, status, timestamp) {
            totalCalls++;
            
            const isProduction = url.includes('api.rumahdaisycantik.com');
            const isLocalhost = url.includes('localhost') || url.startsWith('/api/');
            
            if (isProduction) productionCalls++;
            if (isLocalhost) localhostCalls++;
            
            const card = document.createElement('div');
            card.className = `monitor-card ${isProduction ? 'success' : (isLocalhost ? 'error' : 'warning')}`;
            
            const statusIcon = status >= 200 && status < 300 ? '‚úÖ' : '‚ùå';
            const apiType = isProduction ? 'üåê PRODUCTION' : (isLocalhost ? 'üè† LOCALHOST' : '‚ùì OTHER');
            
            card.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <strong>${statusIcon} ${method} ${apiType}</strong>
                        <div class="api-call ${isProduction ? 'production-call' : 'localhost-call'}">${url}</div>
                    </div>
                    <div style="text-align: right; font-size: 12px; color: #666;">
                        <div>Status: ${status}</div>
                        <div>${timestamp}</div>
                    </div>
                </div>
            `;
            
            monitorDiv.insertBefore(card, monitorDiv.firstChild);
            updateStats();
            
            // Keep only last 20 entries
            while (monitorDiv.children.length > 20) {
                monitorDiv.removeChild(monitorDiv.lastChild);
            }
        }

        function startMonitoring() {
            if (isMonitoring) return;
            
            isMonitoring = true;
            
            // Intercept fetch API
            const originalFetch = window.fetch;
            window.fetch = function(...args) {
                const url = args[0];
                const options = args[1] || {};
                const method = options.method || 'GET';
                const timestamp = new Date().toLocaleTimeString();
                
                return originalFetch.apply(this, args)
                    .then(response => {
                        logApiCall(method, url, response.status, timestamp);
                        return response;
                    })
                    .catch(error => {
                        logApiCall(method, url, 'ERROR', timestamp);
                        throw error;
                    });
            };
            
            // Add initial monitoring message
            const card = document.createElement('div');
            card.className = 'monitor-card info';
            card.innerHTML = `
                <div><strong>üîç Monitoring Started</strong></div>
                <div>All fetch() API calls will be logged here...</div>
                <div style="font-size: 12px; color: #666; margin-top: 10px;">
                    Open your React app (http://127.0.0.1:8080) in another tab and use it normally.
                    API calls will appear here in real-time.
                </div>
            `;
            monitorDiv.appendChild(card);
        }

        function clearLog() {
            monitorDiv.innerHTML = '';
            totalCalls = 0;
            productionCalls = 0;
            localhostCalls = 0;
            updateStats();
        }

        // Auto-start monitoring
        startMonitoring();
    </script>
</body>
</html>