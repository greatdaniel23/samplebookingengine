<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Package API PUT Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; border-radius: 5px; }
        textarea { width: 100%; height: 200px; font-family: monospace; }
        button { padding: 10px 20px; background: #007cba; color: white; border: none; border-radius: 3px; cursor: pointer; }
        button:hover { background: #005a87; }
        .response { background: #f5f5f5; padding: 15px; border-radius: 3px; margin-top: 10px; white-space: pre-wrap; font-family: monospace; }
        .error { background: #ffe6e6; color: #cc0000; }
        .success { background: #e6ffe6; color: #008000; }
        .info { background: #e6f3ff; color: #0066cc; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ§ª Package API PUT Test</h1>
        <p>Test the packages.php PUT endpoint to debug the 500 error.</p>

        <div class="test-section">
            <h3>1. Get Package (to see current data)</h3>
            <button onclick="getPackage()">Get Package ID: 1</button>
            <div id="getResponse" class="response"></div>
        </div>

        <div class="test-section">
            <h3>2. Update Package (PUT Request)</h3>
            <label for="putData">JSON Data to Send:</label>
            <textarea id="putData">{
  "id": 1,
  "name": "Updated Romantic Getaway",
  "description": "Perfect for couples seeking a romantic escape with champagne, rose petals, and spa treatments - UPDATED!",
  "type": "Romance",
  "price": 329.99,
  "max_guests": 2,
  "available": 1,
  "inclusions": ["Champagne bottle", "Rose petals setup", "Couples massage", "Late checkout", "Welcome fruits"],
  "min_nights": 2,
  "max_nights": 5,
  "discount_percentage": 20
}</textarea>
            <br><br>
            <button onclick="updatePackage()">Send PUT Request</button>
            <div id="putResponse" class="response"></div>
        </div>

        <div class="test-section">
            <h3>3. Verify Update (Get Package Again)</h3>
            <button onclick="verifyUpdate()">Verify Package Was Updated</button>
            <div id="verifyResponse" class="response"></div>
        </div>
    </div>

    <script>
        const API_BASE = 'https://api.rumahdaisycantik.com';
        // For local testing, use: const API_BASE = 'http://localhost/fontend-bookingengine-100/frontend-booking-engine-1/api';

        async function getPackage() {
            const responseDiv = document.getElementById('getResponse');
            responseDiv.textContent = 'Loading...';
            responseDiv.className = 'response info';

            try {
                const response = await fetch(`${API_BASE}/packages.php?id=1`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                const data = await response.json();
                responseDiv.textContent = `Status: ${response.status}\n\n${JSON.stringify(data, null, 2)}`;
                responseDiv.className = response.ok ? 'response success' : 'response error';
            } catch (error) {
                responseDiv.textContent = `Error: ${error.message}`;
                responseDiv.className = 'response error';
            }
        }

        async function updatePackage() {
            const responseDiv = document.getElementById('putResponse');
            const jsonData = document.getElementById('putData').value;

            responseDiv.textContent = 'Sending PUT request...';
            responseDiv.className = 'response info';

            try {
                const data = JSON.parse(jsonData);
                
                const response = await fetch(`${API_BASE}/packages.php`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                const result = await response.json();
                responseDiv.textContent = `Status: ${response.status}\n\n${JSON.stringify(result, null, 2)}`;
                responseDiv.className = response.ok ? 'response success' : 'response error';
            } catch (error) {
                responseDiv.textContent = `Error: ${error.message}`;
                responseDiv.className = 'response error';
            }
        }

        async function verifyUpdate() {
            const responseDiv = document.getElementById('verifyResponse');
            responseDiv.textContent = 'Verifying update...';
            responseDiv.className = 'response info';

            try {
                const response = await fetch(`${API_BASE}/packages.php?id=1`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                const data = await response.json();
                responseDiv.textContent = `Status: ${response.status}\n\n${JSON.stringify(data, null, 2)}`;
                responseDiv.className = response.ok ? 'response success' : 'response error';
            } catch (error) {
                responseDiv.textContent = `Error: ${error.message}`;
                responseDiv.className = 'response error';
            }
        }

        // Auto-load initial package data
        window.onload = function() {
            getPackage();
        };
    </script>
</body>
</html>