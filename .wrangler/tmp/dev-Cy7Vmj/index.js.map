{
  "version": 3,
  "sources": ["../../../src/workers/routes/rooms.ts", "../../../src/workers/routes/packages.ts", "../../../src/workers/routes/villa.ts", "../../../src/workers/index.ts", "../../../node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts", "../../../node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts", "../bundle-WAQ1Bn/middleware-insertion-facade.js", "../../../node_modules/wrangler/templates/middleware/common.ts", "../bundle-WAQ1Bn/middleware-loader.entry.ts"],
  "sourceRoot": "C:\\xampp\\htdocs\\frontend-booking-engine to cloudflare\\.wrangler\\tmp\\dev-Cy7Vmj",
  "sourcesContent": ["import { Env } from '../types';\r\n\r\nexport async function handleRooms(url: URL, method: string, body: any, env: Env): Promise<Response> {\r\n  const pathParts = url.pathname.split('/').filter(Boolean);\r\n\r\n  // GET /api/rooms - list all rooms\r\n  if (pathParts.length === 2 && method === 'GET') {\r\n    try {\r\n      const result = await env.DB.prepare(\r\n        'SELECT * FROM rooms WHERE is_active = 1 ORDER BY name'\r\n      ).all();\r\n      \r\n      return new Response(JSON.stringify({ \r\n        success: true, \r\n        data: result.results \r\n      }), {\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Access-Control-Allow-Origin': '*',\r\n        },\r\n      });\r\n    } catch (error: any) {\r\n      return new Response(JSON.stringify({ \r\n        success: false, \r\n        error: error.message \r\n      }), { \r\n        status: 500,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Access-Control-Allow-Origin': '*',\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  // GET /api/rooms/:id - get single room\r\n  if (pathParts.length === 3 && method === 'GET') {\r\n    try {\r\n      const id = parseInt(pathParts[2]);\r\n      const result = await env.DB.prepare(\r\n        'SELECT * FROM rooms WHERE id = ?'\r\n      ).bind(id).first();\r\n      \r\n      if (!result) {\r\n        return new Response(JSON.stringify({ \r\n          success: false, \r\n          error: 'Room not found' \r\n        }), { \r\n          status: 404,\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Access-Control-Allow-Origin': '*',\r\n          },\r\n        });\r\n      }\r\n      \r\n      return new Response(JSON.stringify({ \r\n        success: true, \r\n        data: result \r\n      }), {\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Access-Control-Allow-Origin': '*',\r\n        },\r\n      });\r\n    } catch (error: any) {\r\n      return new Response(JSON.stringify({ \r\n        success: false, \r\n        error: error.message \r\n      }), { \r\n        status: 500,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Access-Control-Allow-Origin': '*',\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  return new Response(JSON.stringify({ \r\n    success: false, \r\n    error: 'Invalid rooms endpoint' \r\n  }), { \r\n    status: 404,\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Access-Control-Allow-Origin': '*',\r\n    },\r\n  });\r\n}\r\n", "import { Env } from '../types';\r\n\r\nexport async function handlePackages(url: URL, method: string, body: any, env: Env): Promise<Response> {\r\n  const pathParts = url.pathname.split('/').filter(Boolean);\r\n\r\n  // GET /api/packages - list all packages\r\n  if (pathParts.length === 2 && method === 'GET') {\r\n    try {\r\n      const result = await env.DB.prepare(\r\n        'SELECT * FROM packages WHERE is_active = 1 ORDER BY name'\r\n      ).all();\r\n      \r\n      return new Response(JSON.stringify({ \r\n        success: true, \r\n        data: result.results \r\n      }), {\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Access-Control-Allow-Origin': '*',\r\n        },\r\n      });\r\n    } catch (error: any) {\r\n      return new Response(JSON.stringify({ \r\n        success: false, \r\n        error: error.message \r\n      }), { \r\n        status: 500,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Access-Control-Allow-Origin': '*',\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  // GET /api/packages/:id - get single package\r\n  if (pathParts.length === 3 && method === 'GET') {\r\n    try {\r\n      const id = parseInt(pathParts[2]);\r\n      const result = await env.DB.prepare(\r\n        'SELECT * FROM packages WHERE id = ?'\r\n      ).bind(id).first();\r\n      \r\n      if (!result) {\r\n        return new Response(JSON.stringify({ \r\n          success: false, \r\n          error: 'Package not found' \r\n        }), { \r\n          status: 404,\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Access-Control-Allow-Origin': '*',\r\n          },\r\n        });\r\n      }\r\n      \r\n      return new Response(JSON.stringify({ \r\n        success: true, \r\n        data: result \r\n      }), {\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Access-Control-Allow-Origin': '*',\r\n        },\r\n      });\r\n    } catch (error: any) {\r\n      return new Response(JSON.stringify({ \r\n        success: false, \r\n        error: error.message \r\n      }), { \r\n        status: 500,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Access-Control-Allow-Origin': '*',\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  // GET /api/packages/:id/rooms - get package rooms\r\n  if (pathParts.length === 4 && pathParts[3] === 'rooms' && method === 'GET') {\r\n    try {\r\n      const packageId = parseInt(pathParts[2]);\r\n      const result = await env.DB.prepare(`\r\n        SELECT pr.*, r.name as room_name, r.description as room_description\r\n        FROM package_rooms pr\r\n        JOIN rooms r ON pr.room_id = r.id\r\n        WHERE pr.package_id = ? AND pr.is_active = 1\r\n        ORDER BY pr.is_default DESC, pr.availability_priority\r\n      `).bind(packageId).all();\r\n      \r\n      return new Response(JSON.stringify({ \r\n        success: true, \r\n        data: result.results \r\n      }), {\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Access-Control-Allow-Origin': '*',\r\n        },\r\n      });\r\n    } catch (error: any) {\r\n      return new Response(JSON.stringify({ \r\n        success: false, \r\n        error: error.message \r\n      }), { \r\n        status: 500,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Access-Control-Allow-Origin': '*',\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  // GET /api/packages/:id/inclusions - get package inclusions\r\n  if (pathParts.length === 4 && pathParts[3] === 'inclusions' && method === 'GET') {\r\n    try {\r\n      const packageId = parseInt(pathParts[2]);\r\n      const result = await env.DB.prepare(`\r\n        SELECT pi.*, i.name, i.description, i.icon\r\n        FROM package_inclusions pi\r\n        JOIN inclusions i ON pi.inclusion_id = i.id\r\n        WHERE pi.package_id = ? AND pi.is_active = 1\r\n        ORDER BY i.name\r\n      `).bind(packageId).all();\r\n      \r\n      return new Response(JSON.stringify({ \r\n        success: true, \r\n        data: result.results \r\n      }), {\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Access-Control-Allow-Origin': '*',\r\n        },\r\n      });\r\n    } catch (error: any) {\r\n      return new Response(JSON.stringify({ \r\n        success: false, \r\n        error: error.message \r\n      }), { \r\n        status: 500,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Access-Control-Allow-Origin': '*',\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  return new Response(JSON.stringify({ \r\n    success: false, \r\n    error: 'Invalid packages endpoint' \r\n  }), { \r\n    status: 404,\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Access-Control-Allow-Origin': '*',\r\n    },\r\n  });\r\n}\r\n", "import { Env } from '../types';\r\n\r\nexport async function handleVilla(url: URL, method: string, body: any, env: Env): Promise<Response> {\r\n  const pathParts = url.pathname.split('/').filter(Boolean);\r\n\r\n  // GET /api/villa - get villa information\r\n  if (pathParts.length === 2 && method === 'GET') {\r\n    try {\r\n      const result = await env.DB.prepare(\r\n        'SELECT * FROM villa_info LIMIT 1'\r\n      ).first();\r\n      \r\n      if (!result) {\r\n        return new Response(JSON.stringify({ \r\n          success: false, \r\n          error: 'Villa information not found' \r\n        }), { \r\n          status: 404,\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Access-Control-Allow-Origin': '*',\r\n          },\r\n        });\r\n      }\r\n      \r\n      // Transform database fields to match frontend VillaInfo interface\r\n      const transformedData = {\r\n        id: result.id,\r\n        name: result.name || 'Villa Name',\r\n        location: result.location || '',\r\n        description: result.description || '',\r\n        rating: 4.5, // Default rating - can be calculated from reviews later\r\n        reviews: 0, // Default reviews count\r\n        images: result.images ? JSON.parse(result.images as string) : [],\r\n        amenities: result.amenities_summary ? \r\n          result.amenities_summary.split(',').map((item: string) => ({\r\n            name: item.trim(),\r\n            icon: 'Star' // Default icon\r\n          })) : [],\r\n        // Contact Information\r\n        phone: result.phone || '',\r\n        email: result.email || '',\r\n        website: result.website || '',\r\n        // Address Information\r\n        address: result.address || '',\r\n        city: result.location ? result.location.split(',')[0].trim() : '',\r\n        state: result.location ? result.location.split(',')[1]?.trim() || '' : '',\r\n        zipCode: '',\r\n        country: result.location ? result.location.split(',').pop()?.trim() || '' : '',\r\n        // Additional Information\r\n        checkInTime: result.check_in_time || '14:00',\r\n        checkOutTime: result.check_out_time || '12:00',\r\n        maxGuests: result.max_guests || 10,\r\n        bedrooms: result.total_rooms || 5,\r\n        bathrooms: result.total_bathrooms || 5,\r\n        pricePerNight: 0, // Will be calculated from rooms\r\n        currency: 'USD',\r\n        // Policies\r\n        cancellationPolicy: result.policies || '',\r\n        houseRules: result.policies || '',\r\n        // Social Media\r\n        socialMedia: {\r\n          facebook: '',\r\n          instagram: '',\r\n          twitter: ''\r\n        }\r\n      };\r\n      \r\n      return new Response(JSON.stringify({ \r\n        success: true, \r\n        data: transformedData \r\n      }), {\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Access-Control-Allow-Origin': '*',\r\n        },\r\n      });\r\n    } catch (error: any) {\r\n      return new Response(JSON.stringify({ \r\n        success: false, \r\n        error: error.message \r\n      }), { \r\n        status: 500,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Access-Control-Allow-Origin': '*',\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  // PUT /api/villa - update villa information\r\n  if (pathParts.length === 2 && method === 'PUT') {\r\n    try {\r\n      if (!body) {\r\n        return new Response(JSON.stringify({ \r\n          success: false, \r\n          error: 'Request body is required' \r\n        }), { \r\n          status: 400,\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Access-Control-Allow-Origin': '*',\r\n          },\r\n        });\r\n      }\r\n\r\n      // Transform frontend camelCase to database snake_case\r\n      const updateData: any = {\r\n        name: body.name,\r\n        description: body.description,\r\n        location: body.location || `${body.city || ''}, ${body.state || ''}, ${body.country || ''}`.trim(),\r\n        max_guests: body.maxGuests,\r\n        total_rooms: body.bedrooms,\r\n        total_bathrooms: body.bathrooms,\r\n        size_sqm: body.sizeSqm,\r\n        check_in_time: body.checkInTime,\r\n        check_out_time: body.checkOutTime,\r\n        phone: body.phone,\r\n        email: body.email,\r\n        website: body.website,\r\n        address: body.address,\r\n        policies: body.cancellationPolicy || body.houseRules,\r\n        amenities_summary: body.amenities ? \r\n          body.amenities.map((a: any) => a.name).join(', ') : \r\n          '',\r\n        images: body.images ? JSON.stringify(body.images) : '[]'\r\n      };\r\n\r\n      // Build UPDATE query\r\n      const fields = Object.keys(updateData).filter(k => updateData[k] !== undefined);\r\n      const setClause = fields.map(field => `${field} = ?`).join(', ');\r\n      const values = fields.map(field => updateData[field]);\r\n\r\n      await env.DB.prepare(\r\n        `UPDATE villa_info SET ${setClause} WHERE id = 1`\r\n      ).bind(...values).run();\r\n\r\n      // Fetch updated record\r\n      const result = await env.DB.prepare(\r\n        'SELECT * FROM villa_info WHERE id = 1'\r\n      ).first();\r\n\r\n      if (!result) {\r\n        return new Response(JSON.stringify({ \r\n          success: false, \r\n          error: 'Failed to fetch updated villa information' \r\n        }), { \r\n          status: 500,\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Access-Control-Allow-Origin': '*',\r\n          },\r\n        });\r\n      }\r\n\r\n      // Transform response back to frontend format\r\n      const transformedData = {\r\n        id: result.id,\r\n        name: result.name,\r\n        location: result.location,\r\n        description: result.description,\r\n        rating: 4.5,\r\n        reviews: 0,\r\n        images: result.images ? JSON.parse(result.images as string) : [],\r\n        amenities: result.amenities_summary ? \r\n          result.amenities_summary.split(',').map((item: string) => ({\r\n            name: item.trim(),\r\n            icon: 'Star'\r\n          })) : [],\r\n        phone: result.phone || '',\r\n        email: result.email || '',\r\n        website: result.website || '',\r\n        address: result.address || '',\r\n        city: result.location ? result.location.split(',')[0].trim() : '',\r\n        state: result.location ? result.location.split(',')[1]?.trim() || '' : '',\r\n        zipCode: '',\r\n        country: result.location ? result.location.split(',').pop()?.trim() || '' : '',\r\n        checkInTime: result.check_in_time || '14:00',\r\n        checkOutTime: result.check_out_time || '12:00',\r\n        maxGuests: result.max_guests || 10,\r\n        bedrooms: result.total_rooms || 5,\r\n        bathrooms: result.total_bathrooms || 5,\r\n        pricePerNight: 0,\r\n        currency: 'USD',\r\n        cancellationPolicy: result.policies || '',\r\n        houseRules: result.policies || '',\r\n        socialMedia: {\r\n          facebook: '',\r\n          instagram: '',\r\n          twitter: ''\r\n        }\r\n      };\r\n\r\n      return new Response(JSON.stringify({ \r\n        success: true, \r\n        data: transformedData \r\n      }), {\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Access-Control-Allow-Origin': '*',\r\n        },\r\n      });\r\n    } catch (error: any) {\r\n      return new Response(JSON.stringify({ \r\n        success: false, \r\n        error: error.message \r\n      }), { \r\n        status: 500,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Access-Control-Allow-Origin': '*',\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  return new Response(JSON.stringify({ \r\n    success: false, \r\n    error: 'Invalid villa endpoint' \r\n  }), { \r\n    status: 404,\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Access-Control-Allow-Origin': '*',\r\n    },\r\n  });\r\n}\r\n", "import { Env } from './types';\r\nimport { handleRooms } from './routes/rooms';\r\nimport { handlePackages } from './routes/packages';\r\nimport { handleVilla } from './routes/villa';\r\n\r\n// FORCE REBUILD - Timestamp: 2026-01-09 02:37\r\n// This comment exists only to force Wrangler to rebuild the Worker\r\n\r\nasync function handleRequest(request: Request, env: Env): Promise<Response> {\r\n  const url = new URL(request.url);\r\n  const method = request.method;\r\n  const path = url.pathname;\r\n\r\n  let body = null;\r\n  // Skip JSON parsing for image upload (needs formData)\r\n  if ((method === 'POST' || method === 'PUT') && path !== '/api/images/upload') {\r\n    try {\r\n      body = await request.json();\r\n    } catch (e) {\r\n      return errorResponse('Invalid JSON body', 400);\r\n    }\r\n  }\r\n\r\n  try {\r\n    // Health check\r\n    if (path === '/api/health') {\r\n      return successResponse({\r\n        status: 'REVERTED - THIS SHOULD NOW APPEAR',\r\n        timestamp: new Date().toISOString(),\r\n        version: '3.0.0-reverted-test',\r\n      });\r\n    }\r\n\r\n    // Debug test endpoint\r\n    if (path === '/api/test/debug') {\r\n      return successResponse({\r\n        message: 'Debug test successful',\r\n        requestPath: path,\r\n        requestMethod: method,\r\n      });\r\n    }\r\n\r\n    // Test endpoints\r\n    if (path === '/api/test/bookings') {\r\n      const result = await env.DB.prepare('SELECT COUNT(*) as count FROM bookings').first();\r\n      return successResponse(result);\r\n    }\r\n\r\n    if (path === '/api/test/r2') {\r\n      const objects = await env.IMAGES.list();\r\n      return successResponse({\r\n        bucketAvailable: true,\r\n        objectCount: objects.objects.length,\r\n      });\r\n    }\r\n\r\n    // NEW EMAIL TEST ENDPOINT\r\n    if (path === '/api/test/send-email-test') {\r\n      return successResponse({\r\n        message: 'Email test endpoint is working!',\r\n        status: 'success',\r\n        recipient: 'greatdaniel87@gmail.com',\r\n      });\r\n    }\r\n\r\n    // Bookings routes\r\n    if (path.startsWith('/api/bookings')) {\r\n      return handleBookings(url, method, body, env);\r\n    }\r\n\r\n    // Rooms routes\r\n    if (path.startsWith('/api/rooms')) {\r\n      return handleRooms(url, method, body, env);\r\n    }\r\n\r\n    // Packages routes\r\n    if (path.startsWith('/api/packages')) {\r\n      return handlePackages(url, method, body, env);\r\n    }\r\n\r\n    // Villa routes\r\n    if (path.startsWith('/api/villa')) {\r\n      return handleVilla(url, method, body, env);\r\n    }\r\n\r\n    // Amenities routes\r\n    if (path.startsWith('/api/amenities')) {\r\n      return handleAmenities(url, method, body, env);\r\n    }\r\n\r\n    // Auth routes\r\n    if (path.startsWith('/api/auth')) {\r\n      return handleAuth(url, method, body, env);\r\n    }\r\n\r\n    // Images routes\r\n    if (path.startsWith('/api/images')) {\r\n      return handleImages(url, method, request, env);\r\n    }\r\n\r\n    // Admin routes\r\n    if (path.startsWith('/api/admin')) {\r\n      return handleAdmin(url, method, body, env);\r\n    }\r\n\r\n    // Settings routes\r\n    if (path.startsWith('/api/settings')) {\r\n      return handleSettings(url, method, body, env);\r\n    }\r\n\r\n    // Email routes\r\n    if (path.startsWith('/api/email')) {\r\n      return handleEmail(url, method, body, env);\r\n    }\r\n\r\n    return errorResponse('Endpoint not found', 404);\r\n  } catch (error) {\r\n    console.error('Request error:', error);\r\n    return errorResponse(error.message || 'Internal server error', 500);\r\n  }\r\n}\r\n\r\nfunction successResponse(data: any): Response {\r\n  return new Response(JSON.stringify({ success: true, data }), {\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Access-Control-Allow-Origin': '*',\r\n      'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\r\n      'Access-Control-Allow-Headers': 'Content-Type, Authorization',\r\n    },\r\n  });\r\n}\r\n\r\nfunction errorResponse(message: string, status = 500): Response {\r\n  return new Response(JSON.stringify({ success: false, error: message }), {\r\n    status,\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Access-Control-Allow-Origin': '*',\r\n    },\r\n  });\r\n}\r\n\r\n// ==================== BOOKINGS ====================\r\nasync function handleBookings(url: URL, method: string, body: any, env: Env): Promise<Response> {\r\n  const pathParts = url.pathname.split('/').filter(Boolean);\r\n\r\n  // GET /api/bookings - list all bookings (default)\r\n  if (pathParts.length === 2 && method === 'GET') {\r\n    try {\r\n      const limit = parseInt(url.searchParams.get('limit') || '100');\r\n      const offset = parseInt(url.searchParams.get('offset') || '0');\r\n      const result = await env.DB.prepare(\r\n        'SELECT * FROM bookings ORDER BY created_at DESC LIMIT ? OFFSET ?'\r\n      ).bind(limit, offset).all();\r\n      return successResponse(result.results);\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  // GET /api/bookings/list\r\n  if (pathParts[2] === 'list' && method === 'GET') {\r\n    try {\r\n      const limit = parseInt(url.searchParams.get('limit') || '50');\r\n      const offset = parseInt(url.searchParams.get('offset') || '0');\r\n      const result = await env.DB.prepare(\r\n        'SELECT * FROM bookings ORDER BY created_at DESC LIMIT ? OFFSET ?'\r\n      ).bind(limit, offset).all();\r\n      return successResponse(result.results);\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  // GET /api/bookings/:id\r\n  if (pathParts[2] && !isNaN(Number(pathParts[2])) && method === 'GET') {\r\n    try {\r\n      const id = parseInt(pathParts[2]);\r\n      const result = await env.DB.prepare('SELECT * FROM bookings WHERE id = ?').bind(id).first();\r\n      if (!result) return errorResponse('Booking not found', 404);\r\n      return successResponse(result);\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  // GET /api/bookings/ref/:reference\r\n  if (pathParts[2] === 'ref' && pathParts[3] && method === 'GET') {\r\n    try {\r\n      const ref = pathParts[3];\r\n      const result = await env.DB.prepare('SELECT * FROM bookings WHERE booking_reference = ?').bind(ref).first();\r\n      if (!result) return errorResponse('Booking not found', 404);\r\n      return successResponse(result);\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  // POST /api/bookings/create\r\n  if (pathParts[2] === 'create' && method === 'POST') {\r\n    try {\r\n      if (!body.booking_reference || !body.email || !body.check_in || !body.check_out) {\r\n        return errorResponse('Missing required fields: booking_reference, email, check_in, check_out', 400);\r\n      }\r\n\r\n      await env.DB.prepare(\r\n        `INSERT INTO bookings (\r\n          booking_reference, room_id, package_id, first_name, last_name, email, phone,\r\n          check_in, check_out, guests, adults, children, total_price, currency,\r\n          special_requests, source, status, payment_status, created_at, updated_at\r\n        ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, datetime('now'), datetime('now'))`\r\n      ).bind(\r\n        body.booking_reference,\r\n        body.room_id || null,\r\n        body.package_id || null,\r\n        body.first_name,\r\n        body.last_name,\r\n        body.email,\r\n        body.phone || null,\r\n        body.check_in,\r\n        body.check_out,\r\n        body.guests,\r\n        body.adults || body.guests,\r\n        body.children || 0,\r\n        body.total_price,\r\n        body.currency || 'USD',\r\n        body.special_requests || null,\r\n        body.source || 'direct',\r\n        'pending',\r\n        'pending'\r\n      ).run();\r\n\r\n      return successResponse({\r\n        booking_reference: body.booking_reference,\r\n        message: 'Booking created successfully',\r\n      });\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  // PUT /api/bookings/:id/status\r\n  if (pathParts[3] === 'status' && method === 'PUT') {\r\n    try {\r\n      const id = parseInt(pathParts[2]);\r\n      const { status, payment_status } = body;\r\n\r\n      if (!status) return errorResponse('Status is required', 400);\r\n\r\n      let query = 'UPDATE bookings SET status = ?, updated_at = datetime(\\'now\\')';\r\n      const params: any[] = [status];\r\n\r\n      if (payment_status) {\r\n        query += ', payment_status = ?';\r\n        params.push(payment_status);\r\n      }\r\n\r\n      query += ' WHERE id = ?';\r\n      params.push(id);\r\n\r\n      await env.DB.prepare(query).bind(...params).run();\r\n\r\n      return successResponse({ message: 'Booking status updated' });\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  // GET /api/bookings/dates/search\r\n  if (pathParts[2] === 'dates' && pathParts[3] === 'search' && method === 'GET') {\r\n    try {\r\n      const checkInBefore = url.searchParams.get('check_in_before');\r\n      const checkOutAfter = url.searchParams.get('check_out_after');\r\n\r\n      if (!checkInBefore || !checkOutAfter) {\r\n        return errorResponse('Missing query parameters: check_in_before, check_out_after', 400);\r\n      }\r\n\r\n      const result = await env.DB.prepare(\r\n        `SELECT * FROM bookings\r\n         WHERE check_in <= ? AND check_out >= ?\r\n         ORDER BY check_in ASC`\r\n      ).bind(checkOutAfter, checkInBefore).all();\r\n\r\n      return successResponse(result.results);\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  return errorResponse('Endpoint not found', 404);\r\n}\r\n\r\n// ==================== AMENITIES ====================\r\nasync function handleAmenities(url: URL, method: string, body: any, env: Env): Promise<Response> {\r\n  const pathParts = url.pathname.split('/').filter(Boolean);\r\n\r\n  // GET /api/amenities or /api/amenities/list\r\n  if ((pathParts.length === 2 || pathParts[2] === 'list') && method === 'GET') {\r\n    try {\r\n      const result = await env.DB.prepare(\r\n        'SELECT * FROM amenities WHERE is_active = 1 ORDER BY display_order ASC'\r\n      ).all();\r\n      return successResponse(result.results);\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  // GET /api/amenities/featured\r\n  if (pathParts[2] === 'featured' && method === 'GET') {\r\n    try {\r\n      const result = await env.DB.prepare(\r\n        'SELECT * FROM amenities WHERE is_featured = 1 AND is_active = 1 ORDER BY display_order ASC'\r\n      ).all();\r\n      return successResponse(result.results);\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  // GET /api/amenities/category/:name\r\n  if (pathParts[2] === 'category' && pathParts[3] && method === 'GET') {\r\n    try {\r\n      const category = pathParts[3];\r\n      const result = await env.DB.prepare(\r\n        'SELECT * FROM amenities WHERE category = ? AND is_active = 1 ORDER BY display_order ASC'\r\n      ).bind(category).all();\r\n      return successResponse(result.results);\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  // GET /api/amenities/:id\r\n  if (pathParts[2] && !isNaN(Number(pathParts[2])) && method === 'GET') {\r\n    try {\r\n      const id = parseInt(pathParts[2]);\r\n      const result = await env.DB.prepare('SELECT * FROM amenities WHERE id = ?').bind(id).first();\r\n      if (!result) return errorResponse('Amenity not found', 404);\r\n      return successResponse(result);\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  return errorResponse('Endpoint not found', 404);\r\n}\r\n\r\n// ==================== AUTHENTICATION ====================\r\nasync function handleAuth(url: URL, method: string, body: any, env: Env): Promise<Response> {\r\n  // POST /api/auth/login\r\n  if (url.pathname === '/api/auth/login' && method === 'POST') {\r\n    try {\r\n      if (!body.username || !body.password) {\r\n        return errorResponse('Username and password required', 400);\r\n      }\r\n\r\n      const user = await env.DB.prepare(\r\n        'SELECT id, username, email, role, password_hash FROM users WHERE username = ? AND active = 1'\r\n      ).bind(body.username).first();\r\n\r\n      if (!user) return errorResponse('Invalid credentials', 401);\r\n\r\n      // TODO: Implement proper password verification (bcrypt)\r\n      // For now using placeholder\r\n      const token = Buffer.from(\r\n        JSON.stringify({ id: user.id, username: user.username, role: user.role })\r\n      ).toString('base64');\r\n\r\n      return successResponse({\r\n        token,\r\n        user: { id: user.id, username: user.username, email: user.email, role: user.role },\r\n      });\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  // POST /api/auth/verify\r\n  if (url.pathname === '/api/auth/verify' && method === 'POST') {\r\n    try {\r\n      if (!body.token) return errorResponse('Token required', 400);\r\n\r\n      // TODO: Implement proper JWT verification\r\n      const decoded = JSON.parse(Buffer.from(body.token, 'base64').toString());\r\n      return successResponse({ valid: true, user: decoded });\r\n    } catch (error) {\r\n      return errorResponse('Invalid token', 401);\r\n    }\r\n  }\r\n\r\n  return errorResponse('Endpoint not found', 404);\r\n}\r\n\r\n// ==================== IMAGES ====================\r\nasync function handleImages(url: URL, method: string, request: Request, env: Env): Promise<Response> {\r\n  const R2_PUBLIC_URL = 'https://bookingengine-8g1-boe-kxn.pages.dev';\r\n\r\n  // GET /api/images/list\r\n  if (url.pathname === '/api/images/list' && method === 'GET') {\r\n    try {\r\n      const prefix = url.searchParams.get('prefix') || '';\r\n      const listed = await env.IMAGES.list({ prefix });\r\n\r\n      return successResponse({\r\n        files: listed.objects.map((obj) => ({\r\n          id: obj.key,\r\n          filename: obj.key.split('/').pop(),\r\n          uploaded: obj.uploaded.toISOString(),\r\n          size: obj.size,\r\n          url: `${R2_PUBLIC_URL}/${obj.key}`,\r\n        }))\r\n      });\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  // POST /api/images/upload\r\n  if (url.pathname === '/api/images/upload' && method === 'POST') {\r\n    try {\r\n      const formData = await request.formData();\r\n      const file = formData.get('file') as File;\r\n      const prefix = (formData.get('prefix') as string) || '';\r\n\r\n      if (!file) return errorResponse('No file provided', 400);\r\n\r\n      // Validate file size (max 10MB)\r\n      if (file.size > 10 * 1024 * 1024) {\r\n        return errorResponse('File too large. Max 10MB', 413);\r\n      }\r\n\r\n      // Validate file type\r\n      const allowedMimes = ['image/jpeg', 'image/png', 'image/webp', 'image/avif', 'image/gif'];\r\n      if (!allowedMimes.includes(file.type)) {\r\n        return errorResponse('Invalid file type. Only JPEG, PNG, WebP, AVIF, GIF allowed', 400);\r\n      }\r\n\r\n      // Generate unique filename\r\n      const timestamp = Date.now();\r\n      const randomString = Math.random().toString(36).substring(2, 15);\r\n      const extension = file.name.split('.').pop();\r\n      const filename = `${timestamp}-${randomString}.${extension}`;\r\n      const key = prefix ? `${prefix}${filename}` : filename;\r\n\r\n      // Upload to R2\r\n      const arrayBuffer = await file.arrayBuffer();\r\n      await env.IMAGES.put(key, arrayBuffer, {\r\n        httpMetadata: {\r\n          contentType: file.type,\r\n        },\r\n        customMetadata: {\r\n          originalName: file.name,\r\n          uploadedAt: new Date().toISOString(),\r\n        },\r\n      });\r\n\r\n      return successResponse({\r\n        success: true,\r\n        id: key,\r\n        filename: file.name,\r\n        key: key,\r\n        url: `${R2_PUBLIC_URL}/${key}`,\r\n        uploaded: new Date().toISOString(),\r\n      });\r\n    } catch (error) {\r\n      console.error('R2 upload error:', error);\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  // DELETE /api/images/:imageId (supports nested paths)\r\n  if (url.pathname.startsWith('/api/images/') && method === 'DELETE') {\r\n    try {\r\n      const imageKey = url.pathname.replace('/api/images/', '');\r\n\r\n      await env.IMAGES.delete(imageKey);\r\n\r\n      return successResponse({ success: true, message: 'Image deleted', key: imageKey });\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  return errorResponse('Endpoint not found', 404);\r\n}\r\n\r\n// ==================== ADMIN ====================\r\nasync function handleAdmin(url: URL, method: string, body: any, env: Env): Promise<Response> {\r\n  // GET /api/admin/dashboard\r\n  if (url.pathname === '/api/admin/dashboard' && method === 'GET') {\r\n    try {\r\n      const [bookingsCount, amenitiesCount, usersCount, totalRevenue] = await Promise.all([\r\n        env.DB.prepare('SELECT COUNT(*) as count FROM bookings').first(),\r\n        env.DB.prepare('SELECT COUNT(*) as count FROM amenities').first(),\r\n        env.DB.prepare('SELECT COUNT(*) as count FROM users').first(),\r\n        env.DB.prepare('SELECT COALESCE(SUM(total_price), 0) as total FROM bookings WHERE payment_status = ?').bind('completed').first(),\r\n      ]);\r\n\r\n      return successResponse({\r\n        bookingsCount: (bookingsCount as any).count || 0,\r\n        amenitiesCount: (amenitiesCount as any).count || 0,\r\n        usersCount: (usersCount as any).count || 0,\r\n        totalRevenue: (totalRevenue as any).total || 0,\r\n      });\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  // GET /api/admin/analytics\r\n  if (url.pathname === '/api/admin/analytics' && method === 'GET') {\r\n    try {\r\n      const result = await env.DB.prepare(\r\n        'SELECT SUM(bookings_count) as bookings, SUM(revenue) as revenue, COUNT(*) as days FROM daily_analytics LIMIT 30'\r\n      ).first();\r\n      return successResponse(result);\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  return errorResponse('Endpoint not found', 404);\r\n}\r\n\r\n// ==================== SETTINGS ====================\r\nasync function handleSettings(url: URL, method: string, body: any, env: Env): Promise<Response> {\r\n  const pathParts = url.pathname.split('/').filter(Boolean);\r\n  const settingKey = pathParts[2];\r\n\r\n  // GET /api/settings - Get all settings\r\n  if (method === 'GET' && !settingKey) {\r\n    try {\r\n      // Try to get from KV first (faster)\r\n      const cachedSettings = await env.CACHE.get('app_settings', 'json');\r\n      if (cachedSettings) {\r\n        return successResponse(cachedSettings);\r\n      }\r\n\r\n      // Fallback to defaults\r\n      const defaultSettings = {\r\n        admin_email: env.ADMIN_EMAIL || 'danielsantosomarketing2017@gmail.com',\r\n        villa_name: env.VILLA_NAME || 'Best Villa Bali',\r\n        from_email: env.FROM_EMAIL || 'danielsantosomarketing2017@gmail.com',\r\n      };\r\n      return successResponse(defaultSettings);\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  // GET /api/settings/:key - Get specific setting\r\n  if (method === 'GET' && settingKey) {\r\n    try {\r\n      const settings = await env.CACHE.get('app_settings', 'json') as any;\r\n      if (settings && settings[settingKey]) {\r\n        return successResponse({ key: settingKey, value: settings[settingKey] });\r\n      }\r\n      // Return env default\r\n      const defaults: any = {\r\n        admin_email: env.ADMIN_EMAIL || 'danielsantosomarketing2017@gmail.com',\r\n        villa_name: env.VILLA_NAME || 'Best Villa Bali',\r\n      };\r\n      return successResponse({ key: settingKey, value: defaults[settingKey] || null });\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  // POST /api/settings - Update settings\r\n  if (method === 'POST') {\r\n    try {\r\n      const { admin_email, villa_name, from_email } = body;\r\n\r\n      // Get existing settings\r\n      const existing = await env.CACHE.get('app_settings', 'json') as any || {};\r\n\r\n      // Merge with new values\r\n      const updatedSettings = {\r\n        ...existing,\r\n        admin_email: admin_email || existing.admin_email || env.ADMIN_EMAIL,\r\n        villa_name: villa_name || existing.villa_name || env.VILLA_NAME,\r\n        from_email: from_email || existing.from_email || env.FROM_EMAIL,\r\n        updated_at: new Date().toISOString(),\r\n      };\r\n\r\n      // Store in KV (no expiration - permanent)\r\n      await env.CACHE.put('app_settings', JSON.stringify(updatedSettings));\r\n\r\n      return successResponse({\r\n        message: 'Settings updated successfully',\r\n        settings: updatedSettings,\r\n      });\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  // PUT /api/settings/:key - Update single setting\r\n  if (method === 'PUT' && settingKey) {\r\n    try {\r\n      const { value } = body;\r\n\r\n      // Get existing settings\r\n      const existing = await env.CACHE.get('app_settings', 'json') as any || {};\r\n\r\n      // Update specific key\r\n      existing[settingKey] = value;\r\n      existing.updated_at = new Date().toISOString();\r\n\r\n      // Store in KV\r\n      await env.CACHE.put('app_settings', JSON.stringify(existing));\r\n\r\n      return successResponse({\r\n        message: `Setting '${settingKey}' updated successfully`,\r\n        key: settingKey,\r\n        value: value,\r\n      });\r\n    } catch (error) {\r\n      return errorResponse(error.message);\r\n    }\r\n  }\r\n\r\n  return errorResponse('Settings endpoint not found', 404);\r\n}\r\n\r\n// Helper function to get admin email (checks KV first, then env)\r\nasync function getAdminEmail(env: Env): Promise<string> {\r\n  try {\r\n    const settings = await env.CACHE.get('app_settings', 'json') as any;\r\n    if (settings && settings.admin_email) {\r\n      return settings.admin_email;\r\n    }\r\n  } catch (e) {\r\n    console.error('Error getting admin email from KV:', e);\r\n  }\r\n  return env.ADMIN_EMAIL || 'danielsantosomarketing2017@gmail.com';\r\n}\r\n\r\n// ==================== EMAIL ====================\r\nasync function handleEmail(url: URL, method: string, body: any, env: Env): Promise<Response> {\r\n  if (method !== 'POST') {\r\n    return errorResponse('Only POST method allowed', 405);\r\n  }\r\n\r\n  const pathParts = url.pathname.split('/').filter(Boolean);\r\n  const action = pathParts[2];\r\n\r\n  try {\r\n    // Send booking confirmation email\r\n    if (action === 'booking-confirmation') {\r\n      const { booking_data } = body;\r\n\r\n      if (!booking_data || !booking_data.guest_email) {\r\n        return errorResponse('Missing booking_data or guest_email', 400);\r\n      }\r\n\r\n      // Send real email via Resend API\r\n      const emailHtml = getBookingConfirmationHtml(booking_data, env);\r\n      const resendResult = await sendEmailViaResend(\r\n        env,\r\n        booking_data.guest_email,\r\n        `\uD83C\uDF89 Booking Confirmation - ${env.VILLA_NAME || 'Best Villa Bali'}`,\r\n        emailHtml\r\n      );\r\n\r\n      // Store email record in KV\r\n      await env.CACHE.put(\r\n        `email:${booking_data.booking_reference}:guest`,\r\n        JSON.stringify({\r\n          to: booking_data.guest_email,\r\n          type: 'booking_confirmation',\r\n          sent_at: new Date().toISOString(),\r\n          booking_data: booking_data,\r\n          resend_id: resendResult.id,\r\n        }),\r\n        { expirationTtl: 86400 * 30 }\r\n      );\r\n\r\n      return successResponse({\r\n        success: true,\r\n        message: 'Booking confirmation email sent successfully',\r\n        recipient: booking_data.guest_email,\r\n        booking_reference: booking_data.booking_reference,\r\n        timestamp: new Date().toISOString(),\r\n        email_id: resendResult.id,\r\n        resend_error: (resendResult as any).error || null,\r\n      });\r\n    }\r\n\r\n    // Send admin notification email\r\n    if (action === 'admin-notification') {\r\n      const { booking_data } = body;\r\n      // Get admin email from KV (dynamic) or fallback to env\r\n      const adminEmail = await getAdminEmail(env);\r\n\r\n      // Send real email via Resend API\r\n      const emailHtml = getAdminNotificationHtml(booking_data, env);\r\n      const resendResult = await sendEmailViaResend(\r\n        env,\r\n        adminEmail,\r\n        `\uD83D\uDD14 New Booking Alert - ${booking_data?.booking_reference || 'New Booking'}`,\r\n        emailHtml\r\n      );\r\n\r\n      // Store email record\r\n      await env.CACHE.put(\r\n        `email:${booking_data?.booking_reference}:admin`,\r\n        JSON.stringify({\r\n          to: adminEmail,\r\n          type: 'admin_notification',\r\n          sent_at: new Date().toISOString(),\r\n          booking_data: booking_data,\r\n          resend_id: resendResult.id,\r\n        }),\r\n        { expirationTtl: 86400 * 30 }\r\n      );\r\n\r\n      return successResponse({\r\n        success: true,\r\n        message: 'Admin notification email sent successfully',\r\n        recipient: adminEmail,\r\n        booking_reference: booking_data?.booking_reference,\r\n        timestamp: new Date().toISOString(),\r\n        email_id: resendResult.id,\r\n      });\r\n    }\r\n\r\n    // Send status change notification\r\n    if (action === 'status-change') {\r\n      const { booking_data, old_status, new_status } = body;\r\n\r\n      const emailResult = {\r\n        success: true,\r\n        message: 'Status change notification sent',\r\n        booking_reference: booking_data?.booking_reference,\r\n        status_change: `${old_status} \u2192 ${new_status}`,\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n\r\n      return successResponse(emailResult);\r\n    }\r\n\r\n    return errorResponse('Unknown email action', 400);\r\n  } catch (error) {\r\n    console.error('Email handler error:', error);\r\n    return errorResponse(error.message || 'Email service error', 500);\r\n  }\r\n}\r\n\r\n// ==================== RESEND EMAIL SERVICE ====================\r\nasync function sendEmailViaResend(env: Env, to: string, subject: string, html: string): Promise<{ id: string, error?: string }> {\r\n  const RESEND_API_KEY = env.RESEND_API_KEY;\r\n\r\n  if (!RESEND_API_KEY) {\r\n    console.error('RESEND_API_KEY not configured');\r\n    return { id: 'no-api-key' };\r\n  }\r\n\r\n  try {\r\n    const response = await fetch('https://api.resend.com/emails', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Authorization': `Bearer ${RESEND_API_KEY}`,\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({\r\n        from: `${env.VILLA_NAME || 'Best Villa Bali'} <booking@bookingengine.com>`,\r\n        to: [to],\r\n        subject: subject,\r\n        html: html,\r\n      }),\r\n    });\r\n\r\n    const result = await response.json();\r\n\r\n    if (!response.ok) {\r\n      console.error('Resend API error:', result);\r\n      return { id: 'error-' + Date.now(), error: JSON.stringify(result) };\r\n    }\r\n\r\n    return { id: result.id || 'sent-' + Date.now() };\r\n  } catch (error) {\r\n    console.error('Resend fetch error:', error);\r\n    return { id: 'error-' + Date.now() };\r\n  }\r\n}\r\n\r\nfunction getBookingConfirmationHtml(booking: any, env: Env): string {\r\n  const villaName = env.VILLA_NAME || 'Best Villa Bali';\r\n  return `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n  <style>\r\n    body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; margin: 0; padding: 0; }\r\n    .container { max-width: 600px; margin: 0 auto; padding: 20px; }\r\n    .header { background: #2E8B57; color: white; padding: 30px; text-align: center; border-radius: 8px 8px 0 0; }\r\n    .content { padding: 30px; background: #f9f9f9; }\r\n    .booking-details { background: white; padding: 20px; border-radius: 8px; margin: 20px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }\r\n    .detail-row { padding: 12px 0; border-bottom: 1px solid #eee; display: flex; }\r\n    .detail-label { font-weight: bold; color: #2E8B57; width: 40%; }\r\n    .detail-value { width: 60%; }\r\n    .footer { padding: 20px; text-align: center; font-size: 12px; color: #666; background: #f0f0f0; border-radius: 0 0 8px 8px; }\r\n    .highlight { background: #e8f5e8; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #2E8B57; }\r\n    h1 { margin: 0; font-size: 28px; }\r\n    h2 { margin: 10px 0 0; font-size: 18px; font-weight: normal; }\r\n  </style>\r\n</head>\r\n<body>\r\n  <div class=\"container\">\r\n    <div class=\"header\">\r\n      <h1>\uD83C\uDFE8 ${villaName}</h1>\r\n      <h2>Booking Confirmation</h2>\r\n    </div>\r\n    <div class=\"content\">\r\n      <div class=\"highlight\">\r\n        <h3 style=\"margin-top:0;\">\u2705 Your booking has been confirmed!</h3>\r\n        <p style=\"margin-bottom:0;\"><strong>Booking Reference:</strong> ${booking.booking_reference || 'BK-' + Date.now()}</p>\r\n      </div>\r\n      \r\n      <div class=\"booking-details\">\r\n        <h3 style=\"margin-top:0;\">\uD83D\uDCCB Booking Details</h3>\r\n        <div class=\"detail-row\">\r\n          <span class=\"detail-label\">Guest Name:</span>\r\n          <span class=\"detail-value\">${booking.guest_name || 'Guest'}</span>\r\n        </div>\r\n        <div class=\"detail-row\">\r\n          <span class=\"detail-label\">Email:</span>\r\n          <span class=\"detail-value\">${booking.guest_email || ''}</span>\r\n        </div>\r\n        <div class=\"detail-row\">\r\n          <span class=\"detail-label\">Check-in:</span>\r\n          <span class=\"detail-value\">${booking.check_in || 'TBD'}</span>\r\n        </div>\r\n        <div class=\"detail-row\">\r\n          <span class=\"detail-label\">Check-out:</span>\r\n          <span class=\"detail-value\">${booking.check_out || 'TBD'}</span>\r\n        </div>\r\n        <div class=\"detail-row\">\r\n          <span class=\"detail-label\">Guests:</span>\r\n          <span class=\"detail-value\">${booking.guests || '1'} guest(s)</span>\r\n        </div>\r\n        <div class=\"detail-row\">\r\n          <span class=\"detail-label\">Room/Package:</span>\r\n          <span class=\"detail-value\">${booking.room_name || 'Standard Room'}</span>\r\n        </div>\r\n        <div class=\"detail-row\" style=\"border-bottom:none;\">\r\n          <span class=\"detail-label\">Total Amount:</span>\r\n          <span class=\"detail-value\"><strong>$${booking.total_amount || '0.00'}</strong></span>\r\n        </div>\r\n      </div>\r\n      \r\n      <p>We look forward to welcoming you!</p>\r\n    </div>\r\n    <div class=\"footer\">\r\n      <p>Thank you for choosing ${villaName} for your Bali getaway.</p>\r\n      <p>${villaName} | Luxury Accommodation in Bali</p>\r\n      <p>Email sent: ${new Date().toLocaleDateString()}</p>\r\n    </div>\r\n  </div>\r\n</body>\r\n</html>`;\r\n}\r\n\r\nfunction getAdminNotificationHtml(booking: any, env: Env): string {\r\n  const villaName = env.VILLA_NAME || 'Best Villa Bali';\r\n  return `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n  <style>\r\n    body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; margin: 0; padding: 0; }\r\n    .container { max-width: 600px; margin: 0 auto; padding: 20px; }\r\n    .header { background: #FF6B35; color: white; padding: 30px; text-align: center; border-radius: 8px 8px 0 0; }\r\n    .content { padding: 30px; background: #f9f9f9; }\r\n    .booking-details { background: white; padding: 20px; border-radius: 8px; margin: 20px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }\r\n    .detail-row { padding: 12px 0; border-bottom: 1px solid #eee; }\r\n    .detail-label { font-weight: bold; color: #FF6B35; display: inline-block; width: 40%; }\r\n    .footer { padding: 20px; text-align: center; font-size: 12px; color: #666; background: #f0f0f0; border-radius: 0 0 8px 8px; }\r\n    .alert { background: #fff3cd; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #FF6B35; }\r\n    h1 { margin: 0; font-size: 28px; }\r\n  </style>\r\n</head>\r\n<body>\r\n  <div class=\"container\">\r\n    <div class=\"header\">\r\n      <h1>\uD83D\uDD14 New Booking Alert</h1>\r\n      <p style=\"margin:10px 0 0;\">${villaName}</p>\r\n    </div>\r\n    <div class=\"content\">\r\n      <div class=\"alert\">\r\n        <h3 style=\"margin-top:0;\">\u26A1 New booking received!</h3>\r\n        <p style=\"margin-bottom:0;\"><strong>Action Required:</strong> Review and confirm booking details</p>\r\n      </div>\r\n      \r\n      <div class=\"booking-details\">\r\n        <h3 style=\"margin-top:0;\">\uD83D\uDCCB Booking Information</h3>\r\n        <div class=\"detail-row\">\r\n          <span class=\"detail-label\">Booking Ref:</span> ${booking?.booking_reference || 'N/A'}\r\n        </div>\r\n        <div class=\"detail-row\">\r\n          <span class=\"detail-label\">Guest Name:</span> ${booking?.guest_name || 'Guest'}\r\n        </div>\r\n        <div class=\"detail-row\">\r\n          <span class=\"detail-label\">Email:</span> ${booking?.guest_email || 'N/A'}\r\n        </div>\r\n        <div class=\"detail-row\">\r\n          <span class=\"detail-label\">Phone:</span> ${booking?.guest_phone || booking?.phone || 'Not provided'}\r\n        </div>\r\n        <div class=\"detail-row\">\r\n          <span class=\"detail-label\">Check-in:</span> ${booking?.check_in || 'TBD'}\r\n        </div>\r\n        <div class=\"detail-row\">\r\n          <span class=\"detail-label\">Check-out:</span> ${booking?.check_out || 'TBD'}\r\n        </div>\r\n        <div class=\"detail-row\">\r\n          <span class=\"detail-label\">Guests:</span> ${booking?.guests || '1'} guest(s)\r\n        </div>\r\n        <div class=\"detail-row\">\r\n          <span class=\"detail-label\">Room/Package:</span> ${booking?.room_name || 'Standard Room'}\r\n        </div>\r\n        <div class=\"detail-row\">\r\n          <span class=\"detail-label\">Total Amount:</span> <strong>$${booking?.total_amount || '0.00'}</strong>\r\n        </div>\r\n        <div class=\"detail-row\">\r\n          <span class=\"detail-label\">Booking Time:</span> ${new Date().toISOString()}\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"footer\">\r\n      <p>${villaName} - Admin Notification System</p>\r\n      <p>${new Date().toLocaleDateString()}</p>\r\n    </div>\r\n  </div>\r\n</body>\r\n</html>`;\r\n}\r\n\r\nexport default {\r\n  async fetch(request: Request, env: Env): Promise<Response> {\r\n    // Handle CORS preflight\r\n    if (request.method === 'OPTIONS') {\r\n      return new Response(null, {\r\n        headers: {\r\n          'Access-Control-Allow-Origin': '*',\r\n          'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\r\n          'Access-Control-Allow-Headers': 'Content-Type, Authorization',\r\n        },\r\n      });\r\n    }\r\n\r\n    return handleRequest(request, env);\r\n  },\r\n};\r\n", "import type { Middleware } from \"./common\";\n\nconst drainBody: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} finally {\n\t\ttry {\n\t\t\tif (request.body !== null && !request.bodyUsed) {\n\t\t\t\tconst reader = request.body.getReader();\n\t\t\t\twhile (!(await reader.read()).done) {}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to drain the unused request body.\", e);\n\t\t}\n\t}\n};\n\nexport default drainBody;\n", "import type { Middleware } from \"./common\";\n\ninterface JsonError {\n\tmessage?: string;\n\tname?: string;\n\tstack?: string;\n\tcause?: JsonError;\n}\n\nfunction reduceError(e: any): JsonError {\n\treturn {\n\t\tname: e?.name,\n\t\tmessage: e?.message ?? String(e),\n\t\tstack: e?.stack,\n\t\tcause: e?.cause === undefined ? undefined : reduceError(e.cause),\n\t};\n}\n\n// See comment in `bundle.ts` for details on why this is needed\nconst jsonError: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} catch (e: any) {\n\t\tconst error = reduceError(e);\n\t\treturn Response.json(error, {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"MF-Experimental-Error-Stack\": \"true\" },\n\t\t});\n\t}\n};\n\nexport default jsonError;\n", "\t\t\t\timport worker, * as OTHER_EXPORTS from \"C:\\\\xampp\\\\htdocs\\\\frontend-booking-engine to cloudflare\\\\src\\\\workers\\\\index.ts\";\n\t\t\t\timport * as __MIDDLEWARE_0__ from \"C:\\\\xampp\\\\htdocs\\\\frontend-booking-engine to cloudflare\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\middleware-ensure-req-body-drained.ts\";\nimport * as __MIDDLEWARE_1__ from \"C:\\\\xampp\\\\htdocs\\\\frontend-booking-engine to cloudflare\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\middleware-miniflare3-json-error.ts\";\n\n\t\t\t\texport * from \"C:\\\\xampp\\\\htdocs\\\\frontend-booking-engine to cloudflare\\\\src\\\\workers\\\\index.ts\";\n\t\t\t\tconst MIDDLEWARE_TEST_INJECT = \"__INJECT_FOR_TESTING_WRANGLER_MIDDLEWARE__\";\n\t\t\t\texport const __INTERNAL_WRANGLER_MIDDLEWARE__ = [\n\t\t\t\t\t\n\t\t\t\t\t__MIDDLEWARE_0__.default,__MIDDLEWARE_1__.default\n\t\t\t\t]\n\t\t\t\texport default worker;", "export type Awaitable<T> = T | Promise<T>;\n// TODO: allow dispatching more events?\nexport type Dispatcher = (\n\ttype: \"scheduled\",\n\tinit: { cron?: string }\n) => Awaitable<void>;\n\nexport type IncomingRequest = Request<\n\tunknown,\n\tIncomingRequestCfProperties<unknown>\n>;\n\nexport interface MiddlewareContext {\n\tdispatch: Dispatcher;\n\tnext(request: IncomingRequest, env: any): Awaitable<Response>;\n}\n\nexport type Middleware = (\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tmiddlewareCtx: MiddlewareContext\n) => Awaitable<Response>;\n\nconst __facade_middleware__: Middleware[] = [];\n\n// The register functions allow for the insertion of one or many middleware,\n// We register internal middleware first in the stack, but have no way of controlling\n// the order that addMiddleware is run in service workers so need an internal function.\nexport function __facade_register__(...args: (Middleware | Middleware[])[]) {\n\t__facade_middleware__.push(...args.flat());\n}\nexport function __facade_registerInternal__(\n\t...args: (Middleware | Middleware[])[]\n) {\n\t__facade_middleware__.unshift(...args.flat());\n}\n\nfunction __facade_invokeChain__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tmiddlewareChain: Middleware[]\n): Awaitable<Response> {\n\tconst [head, ...tail] = middlewareChain;\n\tconst middlewareCtx: MiddlewareContext = {\n\t\tdispatch,\n\t\tnext(newRequest, newEnv) {\n\t\t\treturn __facade_invokeChain__(newRequest, newEnv, ctx, dispatch, tail);\n\t\t},\n\t};\n\treturn head(request, env, ctx, middlewareCtx);\n}\n\nexport function __facade_invoke__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tfinalMiddleware: Middleware\n): Awaitable<Response> {\n\treturn __facade_invokeChain__(request, env, ctx, dispatch, [\n\t\t...__facade_middleware__,\n\t\tfinalMiddleware,\n\t]);\n}\n", "// This loads all middlewares exposed on the middleware object and then starts\n// the invocation chain. The big idea is that we can add these to the middleware\n// export dynamically through wrangler, or we can potentially let users directly\n// add them as a sort of \"plugin\" system.\n\nimport ENTRY, { __INTERNAL_WRANGLER_MIDDLEWARE__ } from \"C:\\\\xampp\\\\htdocs\\\\frontend-booking-engine to cloudflare\\\\.wrangler\\\\tmp\\\\bundle-WAQ1Bn\\\\middleware-insertion-facade.js\";\nimport { __facade_invoke__, __facade_register__, Dispatcher } from \"C:\\\\xampp\\\\htdocs\\\\frontend-booking-engine to cloudflare\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\common.ts\";\nimport type { WorkerEntrypointConstructor } from \"C:\\\\xampp\\\\htdocs\\\\frontend-booking-engine to cloudflare\\\\.wrangler\\\\tmp\\\\bundle-WAQ1Bn\\\\middleware-insertion-facade.js\";\n\n// Preserve all the exports from the worker\nexport * from \"C:\\\\xampp\\\\htdocs\\\\frontend-booking-engine to cloudflare\\\\.wrangler\\\\tmp\\\\bundle-WAQ1Bn\\\\middleware-insertion-facade.js\";\n\nclass __Facade_ScheduledController__ implements ScheduledController {\n\treadonly #noRetry: ScheduledController[\"noRetry\"];\n\n\tconstructor(\n\t\treadonly scheduledTime: number,\n\t\treadonly cron: string,\n\t\tnoRetry: ScheduledController[\"noRetry\"]\n\t) {\n\t\tthis.#noRetry = noRetry;\n\t}\n\n\tnoRetry() {\n\t\tif (!(this instanceof __Facade_ScheduledController__)) {\n\t\t\tthrow new TypeError(\"Illegal invocation\");\n\t\t}\n\t\t// Need to call native method immediately in case uncaught error thrown\n\t\tthis.#noRetry();\n\t}\n}\n\nfunction wrapExportedHandler(worker: ExportedHandler): ExportedHandler {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn worker;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\tconst fetchDispatcher: ExportedHandlerFetchHandler = function (\n\t\trequest,\n\t\tenv,\n\t\tctx\n\t) {\n\t\tif (worker.fetch === undefined) {\n\t\t\tthrow new Error(\"Handler does not export a fetch() function.\");\n\t\t}\n\t\treturn worker.fetch(request, env, ctx);\n\t};\n\n\treturn {\n\t\t...worker,\n\t\tfetch(request, env, ctx) {\n\t\t\tconst dispatcher: Dispatcher = function (type, init) {\n\t\t\t\tif (type === \"scheduled\" && worker.scheduled !== undefined) {\n\t\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\t\tDate.now(),\n\t\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t\t() => {}\n\t\t\t\t\t);\n\t\t\t\t\treturn worker.scheduled(controller, env, ctx);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn __facade_invoke__(request, env, ctx, dispatcher, fetchDispatcher);\n\t\t},\n\t};\n}\n\nfunction wrapWorkerEntrypoint(\n\tklass: WorkerEntrypointConstructor\n): WorkerEntrypointConstructor {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn klass;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\t// `extend`ing `klass` here so other RPC methods remain callable\n\treturn class extends klass {\n\t\t#fetchDispatcher: ExportedHandlerFetchHandler<Record<string, unknown>> = (\n\t\t\trequest,\n\t\t\tenv,\n\t\t\tctx\n\t\t) => {\n\t\t\tthis.env = env;\n\t\t\tthis.ctx = ctx;\n\t\t\tif (super.fetch === undefined) {\n\t\t\t\tthrow new Error(\"Entrypoint class does not define a fetch() function.\");\n\t\t\t}\n\t\t\treturn super.fetch(request);\n\t\t};\n\n\t\t#dispatcher: Dispatcher = (type, init) => {\n\t\t\tif (type === \"scheduled\" && super.scheduled !== undefined) {\n\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\tDate.now(),\n\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t() => {}\n\t\t\t\t);\n\t\t\t\treturn super.scheduled(controller);\n\t\t\t}\n\t\t};\n\n\t\tfetch(request: Request<unknown, IncomingRequestCfProperties>) {\n\t\t\treturn __facade_invoke__(\n\t\t\t\trequest,\n\t\t\t\tthis.env,\n\t\t\t\tthis.ctx,\n\t\t\t\tthis.#dispatcher,\n\t\t\t\tthis.#fetchDispatcher\n\t\t\t);\n\t\t}\n\t};\n}\n\nlet WRAPPED_ENTRY: ExportedHandler | WorkerEntrypointConstructor | undefined;\nif (typeof ENTRY === \"object\") {\n\tWRAPPED_ENTRY = wrapExportedHandler(ENTRY);\n} else if (typeof ENTRY === \"function\") {\n\tWRAPPED_ENTRY = wrapWorkerEntrypoint(ENTRY);\n}\nexport default WRAPPED_ENTRY;\n"],
  "mappings": "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",
  "names": []
}
