<!DOCTYPE html>
<html>
<head>
    <title>üîç Live API URL Test</title>
    <meta charset="utf-8">
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            max-width: 800px; 
            margin: 20px auto; 
            padding: 20px; 
            background: #f8f9fa;
        }
        .test-card { 
            background: white; 
            padding: 20px; 
            border-radius: 8px; 
            margin-bottom: 15px; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.1); 
        }
        .success { border-left: 5px solid #28a745; }
        .error { border-left: 5px solid #dc3545; }
        .code-block { 
            background: #f8f9fa; 
            padding: 15px; 
            border-radius: 4px; 
            font-family: 'Courier New', monospace; 
            font-size: 13px;
            word-break: break-all;
        }
        .button { 
            background: #007bff; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            border-radius: 4px; 
            cursor: pointer; 
            margin: 5px;
        }
        .button:hover { background: #0056b3; }
        .production { background: #d4edda; color: #155724; }
        .localhost { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <div class="test-card">
        <h1>üîç Live API URL Test</h1>
        <p>This page will test what API URLs your React app is actually using right now.</p>
        <button class="button" onclick="testApiUrls()">üß™ Test Current API Configuration</button>
        <button class="button" onclick="clearResults()">üßπ Clear</button>
    </div>

    <div id="results"></div>

    <script>
        const resultsDiv = document.getElementById('results');

        function addResult(title, content, className = '') {
            const card = document.createElement('div');
            card.className = `test-card ${className}`;
            card.innerHTML = `<h3>${title}</h3><div>${content}</div>`;
            resultsDiv.appendChild(card);
        }

        function clearResults() {
            resultsDiv.innerHTML = '';
        }

        async function testApiUrls() {
            clearResults();

            // Test 1: Check what the current page can access
            addResult('üåê Current Page Info', `
                <div class="code-block">
Current URL: ${window.location.href}
Protocol: ${window.location.protocol}
Host: ${window.location.host}
Origin: ${window.location.origin}
                </div>
            `);

            // Test 2: Try to access React build info (if available)
            addResult('‚öõÔ∏è React Environment Test', `
                <div class="code-block">
Testing if we can detect React environment variables...
Note: This HTML page cannot directly access Vite env vars
                </div>
            `);

            // Test 3: Test actual API endpoints
            const endpoints = [
                { name: 'Rooms API (Production)', url: 'https://api.rumahdaisycantik.com/rooms.php' },
                { name: 'Rooms API (Localhost)', url: 'http://localhost/fontend-bookingengine-100/frontend-booking-engine-1/api/rooms.php' },
                { name: 'Villa API (Production)', url: 'https://api.rumahdaisycantik.com/villa.php' },
                { name: 'Villa API (Localhost)', url: 'http://localhost/fontend-bookingengine-100/frontend-booking-engine-1/api/villa.php' }
            ];

            for (const endpoint of endpoints) {
                await testEndpoint(endpoint);
            }

            // Test 4: Check for CORS and network issues
            addResult('üîí CORS & Network Analysis', `
                <div class="code-block">
If production APIs show CORS errors, that's normal from this test page.
If localhost APIs work but production fails, check:
1. Internet connection
2. CORS settings on api.rumahdaisycantik.com
3. Firewall/proxy settings
                </div>
            `, 'success');
        }

        async function testEndpoint(endpoint) {
            const isProduction = endpoint.url.includes('api.rumahdaisycantik.com');
            const isLocalhost = endpoint.url.includes('localhost');
            
            try {
                const startTime = Date.now();
                const response = await fetch(endpoint.url);
                const endTime = Date.now();
                const responseTime = endTime - startTime;

                const className = isProduction ? 'success' : (isLocalhost ? 'error' : '');
                const status = response.ok ? '‚úÖ SUCCESS' : '‚ö†Ô∏è HTTP ERROR';
                const typeLabel = isProduction ? 'üåê PRODUCTION' : 'üè† LOCALHOST';

                addResult(`${status} ${endpoint.name}`, `
                    <div class="code-block ${isProduction ? 'production' : 'localhost'}">
${typeLabel}
URL: ${endpoint.url}
Status: ${response.status} ${response.statusText}
Response Time: ${responseTime}ms
Headers: ${response.headers.get('content-type') || 'Unknown'}
                    </div>
                `, className);

            } catch (error) {
                const className = isProduction ? 'success' : 'error';
                const typeLabel = isProduction ? 'üåê PRODUCTION' : 'üè† LOCALHOST';
                
                addResult(`‚ùå ERROR ${endpoint.name}`, `
                    <div class="code-block ${isProduction ? 'production' : 'localhost'}">
${typeLabel}
URL: ${endpoint.url}
Error: ${error.message}
${error.message.includes('CORS') ? 'This is expected for production API from test page' : 'Network or server issue'}
                    </div>
                `, className);
            }
        }

        // Auto-run test
        testApiUrls();
    </script>
</body>
</html>